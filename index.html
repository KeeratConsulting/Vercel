<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Get a Quote</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; max-width: 720px; margin: 24px auto; padding: 0 12px; }
    label { display:block; margin-top:12px; font-weight:600; }
    input, select, textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; margin-top:6px; }
    button { margin-top:16px; padding:12px 16px; border:0; border-radius:10px; cursor:pointer; }
    .row { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .note{ color:#666; font-size:12px; }
    .ok { color: #0a7a0a; }
    .err { color: #b00020; }
  </style>
</head>
<body>
  <h1>Request a Quote</h1>
  <p class="note">Fill this in and we’ll email you back. You can paste photo links from Google Drive, iCloud, etc.</p>

  <form id="quote">
    <div class="row">
      <div>
        <label>Name<input name="name" required></label>
      </div>
      <div>
        <label>Email<input type="email" name="email" required></label>
      </div>
    </div>

    <div class="row">
      <div><label>Phone<input name="phone" required></label></div>
      <div><label>Postcode<input name="postcode" required></label></div>
    </div>

    <label>Address (optional)<input name="address"></label>

    <label>Service
      <select name="service" required>
        <option value="">Choose…</option>
        <option>Painting & Decorating</option>
        <option>Brickwork / Repointing</option>
        <option>Extensions / Refurb</option>
        <option>Bathroom / Kitchen</option>
        <option>Other</option>
      </select>
    </label>

    <div class="row">
      <div><label>Budget (optional)<input name="budget" placeholder="e.g. £2,000–£5,000"></label></div>
      <div><label>Timeline<input name="timeline" placeholder="e.g. ASAP, next month"></label></div>
    </div>

    <label>Describe the work
      <textarea name="message" rows="5" required></textarea>
    </label>

    <label>Photo URL 1 (optional)<input name="photo_url_1" placeholder="https://…"></label>
    <label>Photo URL 2 (optional)<input name="photo_url_2" placeholder="https://…"></label>
    <label>Photo URL 3 (optional)<input name="photo_url_3" placeholder="https://…"></label>
    <label class="note">Tip: paste share links from your phone’s gallery, Google Drive, Dropbox, iCloud, etc.</label>

    <!-- Honeypot (spam trap) -->
    <input name="source" value="website" hidden>
    <input name="company" style="display:none">

    <button id="btn" type="submit">Send enquiry</button>
    <p id="msg"></p>
  </form>

  <script>
    const f = document.getElementById('quote');
    const btn = document.getElementById('btn');
    const msg = document.getElementById('msg');

    f.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = '';
      btn.disabled = true; btn.textContent = 'Sending…';

      // Ignore bots that fill hidden "company"
      const data = Object.fromEntries(new FormData(f).entries());
      if (data.company) { btn.disabled = false; btn.textContent = 'Send enquiry'; return; }

      try {
        const r = await fetch('/api/contact', {
          method: 'POST',
          headers: { 'Content-Type':'application/json' },
          body: JSON.stringify(data)
        });
        const j = await r.json();
        if (j.ok) {
          msg.textContent = 'Sent! We’ll get back to you shortly.'; msg.className = 'ok';
          f.reset();
        } else {
          msg.textContent = 'Error sending. Please try again or email us directly.'; msg.className = 'err';
        }
      } catch (e) {
        msg.textContent = 'Network error. Please try again.'; msg.className = 'err';
      } finally {
        btn.disabled = false; btn.textContent = 'Send enquiry';
      }
    });
  </script>
</body>
</html>
